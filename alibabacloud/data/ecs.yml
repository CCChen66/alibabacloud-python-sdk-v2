using_product: ecs
api_version: 20140526

registrations:
  -
    type: client
    name: ecs

    api_decorations:

      DescribeInstances:
        param_aliases:
          -
            type: JSON_STRING_TO_LIST
            origin: InstanceIds
            alias: list_of_instance_id

          -
            type: JSON_STRING_TO_LIST
            origin: PrivateIpAddresses
            alias: list_of_private_ip_address

          -
            type: JSON_STRING_TO_LIST
            origin: InnerIpAddresses
            alias: list_of_inner_ip_address

          -
            type: JSON_STRING_TO_LIST
            origin: PublicIpAddresses
            alias: list_of_public_ip_address

          -
            type: JSON_STRING_TO_LIST
            origin: EipAddresses
            alias: list_of_eip_address

      DescribeInstanceHistoryEvents:

        param_aliases:
          -
            type: SIMPLE
            origin: EventIds
            alias: list_of_event_id
          -
            type: SIMPLE
            origin: InstanceEventCycleStatuss
            alias: list_of_event_cycle_status
          -
            type: SIMPLE
            origin: InstanceEventTypes
            alias: list_of_event_type
  -
    type: resource
    name: ecs

    definitions:
      -
        type: collection
        name: instances

  -
    type: resource
    name: ecs.instance
    identifiers: InstanceId

    attributes:                                         # 实体的属性
      from_api: DescribeInstances                       # 实体的属性从那个API获得
      resource_id_in_param: InstanceIds                 # API中传入实体ID的参数
      resource_id_format: SINGLE_ITEM_IN_JSON_STRING    # 枚举，API中实体ID参数的格式
      path_to_resource_item: Instances.Instance         # API返回中，如何获取实例的属性数据

    definitions:
      -
        type: action
        name: start
      -
        type: action
        name: stop
      -
        type: action
        name: reboot
      -
        type: action
        name: delete
      -
        type: modifier
        name: modify_attributes
        api: ModifyInstanceAttribute
      -
        type: waiter
        status: Running
      -
        type: waiter
        status: Starting
      -
        type: waiter
        status: Stopping
      -
        type: waiter
        status: Stopped


  -
    type: resource
    name: ecs.system_event
    identifiers: EventId

    attributes:
      from_api: DescribeInstanceHistoryEvents
      resource_id_in_param: EventIds
      param_format: LIST
      path_to_resource_item: InstanceSystemEventSet.InstanceSystemEventType

    definitions:
      -
        type: enum
        name: EventCycleStatus
        enums:
          SCHEDULED: Scheduled
          AVOIDED: Avoided
          EXECUTING: Executing
          EXECUTED: Executed
          CANCELED: Canceled
          FAILED: Failed
      -
        type: enum
        name: EventType
        enums:
          SYSTEM_MAINTENANCE_REBOOT: SystemMaintenance.Reboot
          SYSTEM_FAILURE_REBOOT: SystemFailure.Reboot
          INSTANCE_FAILURE_REBOOT: InstanceFailure.Reboot
          INSTANCE_EXPIRATION_STOP: InstanceExpiration.Stop
          INSTANCE_EXPIRATION_DELETE: InstanceExpiration.Delete
          ACCOUNT_UNBALANCED_STOP: AccountUnbalanced.Stop
          ACCOUNT_UNBALANCED_DELETE: AccountUnbalanced.Delete